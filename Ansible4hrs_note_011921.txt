
https://github.com/sandervanvugt/ansible-3h


ansible all -m setup -a "filter=ansible_facts"


is there any good site which explains briefly about Jinja filters

M B
https://learning.oreilly.com/library/view/practical-ansible-2/9781789807462/0d9cdb7d-12b9-4749-8389-4cb7599ea212.xhtml

J G
to remove ssh keys from known_hosts: "ssh-keygen -R <IP>"
M B
yum install python3 # does the job

sander v
https://pastebin.com/uQ8S2a0b

S N
$ ssh-copy-id ansible1 /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys Permissio

P S
with hosts file just run, ansible all --list-hosts

M B
@SN > You have to setup sshd to accept password for first connexion

D S
@SN did you create the ansible user on each host

p m
systemctl restart sshd


M S
When I add %wheel to th etc/sudoers it's complaining that : %wheel NOPASSWD is not correctly formatted

P S
Should be...... %wheel ALL=(ALL) NOPASSWD:ALL

M S
%wheel ALL=(ALL) NOPASSWD:ALL

M K
%wheel ALL=(ALL) NOPASSWD: ALL

@MK > git clone https://github.com/sandervanvugt/ansible-3h.git


N S
ansible -i inventory ansible1 -m command -a who

R M
https://docs.ansible.com/ansible/latest/network/getting_started/first_inventory.html

S N
what command is used to get that list of modules?

R M
ansible-doc -l

sander v
https://pastebin.com/u/sandervanvugt

J G
could you add multiple contents underneath the "copy" play?

R M
https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html


A P
another query : How to check the repository to verify that s/w is available ? like Oracle S/W ?

M B
@AP > For exemple with 'ansible all -m command -a "yum search vsftpd"' or better with yum module ;)

ok

M K
@AP what do you mean oracle s/w is available? you're not getting oracle db rpms in repos unless you're on oracle linux ;) as to other - you can use shell/command modules to run appropriate tools for package deployments

M K
@AP - https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html#parameter-list

A P
This was the reason, I asked. no rpm for oracle db is available. I got it from your reply.

M K
@AP you can always create rpms and add them to your local repo on control node, and config yum/rpm on nodes to use this repo... or simply copy packages directly onto the nodes and then run packagemanager modules you need pointing it to that local rpm file


M K
@AP - check something like https://medium.com/oracledevs/devops-series-automate-oracle-19c-rdbms-installations-with-ansible-github-43cfdf344a4a or https://awesomeopensource.com/project/oravirt/ansible-oracle

K B
@AP: You might want to reach out to Oracle directly. Open a service request or talk to your customer service manager. I know based on conversations with DBAs at big companies here in the Dallas area... they're working on Ansible playbooks.

K B
@MK: Good links! I never would have found them!

M K
@AP @KB yeah, they even have their own licensed ansible tower with modules already ready... they can offer it as another subscription/license fee, but they often try to 'encourage' the use of OCI or OracleLinux...

M K
@AP @KB you can always write your own modules... installation usually can be done using response files, and these can be easily created with ansible and its fact and variable usage...

L H
ok

A P
thanks for the link

M K
@AP & @KB - just FYI, IMHO the best option is to use GoldenImages w/RO OraHomes - to deploy all you need is simple file copy/unarchiving + text edits. as a bonus, you're getting a pretty standardised environment that's great for updates later !


M B
Good to know, filter accept wilcard: ansible all -m setup -a "filter=*kernel*"

K B
@MK: Have used GoldenImages for years. Still have to rely on an underlying process to create them. It would be really nice to move to a "declarative" method of creating everything. 
With moving to cloud-based platforms... probably less of an issue over time


K B
@ALL: Anyone using Jinja? Any good links or leads?

S N
is there any good site which explains briefly about Jinja filters

M B
https://learning.oreilly.com/library/view/practical-ansible-2/9781789807462/0d9cdb7d-12b9-4749-8389-4cb7599ea212.xhtml

-----------------------------------------

rhce8-book

base
mkdir group_vars
vi group_vars/file
vi greeter.yaml

---
- name: test group vars
  hosts: file 
  tasks:
  - debug:
     msg: the greeting is {{ greet }} 

tree group_vars/
cat group_vars/file
greet: hellow

cd loops/
vi register2.yml   $ a nice example 


 - name: retrieve the list of home directories
   command: ls /home
   register: home_dirs

...

https://pastebin.com/E86G07v4

- name: debugging
  debug:
    var: home_dirs

--------------------------------------
Sander van Vugt on 011921 

yum install -y vim bash-completion git 

Understanding Ansible

written in Python 
push-based
doesn't require any agent 
Configurations are written in YAML
it uses playbooks to run tasks in a way that always gives the same result
it can manage computers, network devices
It's idempotent: running the same playbook multiple times will give you thesame results 

Ansible was released on 2/20/2012, auther is Michael DeHaan 


Requirements:
           python, ssh, sudo configuration 

Other Configuration Management Solutions
Puppet, chef, Stack 

On Controller:

- Add EPEL repository
- Install ansible software
- Create user "ansible" and generate SSH keys
- Copy SSH keys over to managed nodes
- Setup Inventory and ansible.cfg file

One Managed nodes
- Setup SSH
- Enable sudo for "ansible" user
- Install Python 

Ubutou does not have ssh installed by default, you have to install is seperately, what's why I use CentoOS

- Take care of SSH on all 3 nodes, sudo without password 
--------------------------------

visudo passwdless login for all nodes
ssh-keygen 
ssh-copy-id 
usermod -aG wheel ansible 
scp /etc/hosts ansible:/etc/hosts

The inventory file 
The ansible.cfg file 

Inventory file:
location of the inventory is specified in the ansible.cfg file 

/etc/ansible/hosts
current project directory
specified with the -i option while running Ansible commands

Inventory files can be static and dynamic as script 

cat /etc/sudoers.d/ansible

manifest file to define desired state in YAML, 
module is used accomplish specific tasks in ansible 

ansible-doc -l 

EX294 exam 

Ad hoc is cool, but it not you should doing, just use playbook !!!

Understanding Playbook Components

Understanding Variables
your playbook wants to use variables to put flexible information 

Using variable allow you to separate static code from site specific information and thus make your playbooks more portable
A variable is a label and it uses double curly braces:
tasks:
 - name: Creates the user {{user}}
  user:
    name: "{{user}}"


Lab4: Using Varilables

Write a playbook that installs a software package. Ensure the playbook would work on Ubuntu as well as CentOS. Use a variable to set the default package to "nmap". Run the playbook, overwriting the dault package, and ensure it installs the nginx pacakge

Ansible -> platform 

pxe-boot - dhcp + tftp 

Variables and Facts

Variables are used to separate static code from site specific data

ansible ansible.example.com -m setup -a "filter=ansible_kernel'

Addressing subvariables:

history back compatibility 

injected varilables like 


---------------------
gather_facts: no
-------------------

Using register

cd loop 

it can be used to restore the value of variable

Handlers are like a task, but will only run when they have been triggered by a notify statement 

in ansible, it failing, dependence will stop 

ansible ansible1.exmaple.com -m file -a "state=absent name=/var/www/html/index.html"


Directory Structure
-------------------
include
items ( using loop ) 

un-ansible.yml  # 

Understanding Ansible Vault
To access remote 


Understaning Ansible Tower

Ansible Tower provides a framework for using Ansible at an enterprise level 

RHCE EX294 Cert Guide - 


https://pastebin.com/wfKd4XCh








































   




 
