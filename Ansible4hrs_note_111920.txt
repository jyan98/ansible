
https://github.com/sandervanvugt/ansible-3h


ansible all -m setup -a "filter=ansible_facts"


is there any good site which explains briefly about Jinja filters

M B
https://learning.oreilly.com/library/view/practical-ansible-2/9781789807462/0d9cdb7d-12b9-4749-8389-4cb7599ea212.xhtml

Derek H
Hello everyone, welcome to Ansible in 4 Hours taught by Sander van Vugt. We will begin shortly!

Derek H
Course materials can be accessed in the Resource List.

Derek H
This course is being recorded. It will be ready to view 24-48 hours after class ends, and you will have access to it as long as your O’Reilly Learning account is active.

Derek H
Once available, you will receive an email with access details. You can also view the recordings on the course landing page: https://learning.oreilly.com/live-training/courses/ansible-in-4-hours/0636920464570/

N S
hi from London

Derek H
Class has started and you should be hearing Sander van Vugt. If you have any audio/connection issues during today’s course, try refreshing your browser.

Derek H
Reminder- please post questions into the Q&A widget (instead of this group chat).  Thanks!

G B
Hi everyone

G B
Q: How about 2 physical debian machines?

a v
I'm running centos on hyperv, does that suffice?

f l
Hello Sander!

I H
Cant hear the audio

I H
Even after refreshing the browser

Derek H
IH, make sure you are not muted in the media player.

Derek H
If you hover your mouse over it there is a volume control

Derek H
If that doesn't work try clearing your browser cache or using a different browser if you have one

L F
Hello from italy

J F
Middle America?

M K
He llo from germany

M B
French here :)

E G
Hello from NC

G M
Hello from Costa Rica

L F
buongiorno a te! :D

D I
Hello from Bucharest

A A
Limburg NL

I G
Buenos dias!

F L
Hello from Spain! Buenas tardes

D S
Hi from London

M M
Hello from Portugal!

s r
Hello from Texas!

I G
Texas baby!

M S
Can I use my host machine to do this whole course?

M S
Its Ubuntu 18.04LTS

G B
Thx Sander

L P
debian will be similar to RHEL/CentOS/Fedora

G B
thx LP

S S
hello from Argentina

L P
sorry, I was wrong, I menat similar to ubuntu

L P
same packages than ubuntu

L F
All fine here!

K B
Seeing the tablet

J G
to remove ssh keys from known_hosts: "ssh-keygen -R <IP>"

M K
FYI: yum install python does not work in Centos8

M K
needs to be python36

L F
You have to specify 3 :)

M B
yum install python3 # does the job

M K
any possibility to get this lab without typing all the commands? i am troubleshooting some of the beginning commands, even though i am familiar with linux, i am not with this new centos8 vm

M B
I think you have to make configuration manually but ansible's files are on the github repo

M S
@Sander Im not sure which parts of your commands I shoukd follow through and type along or else how does one learn from such a course?

M K
i am still waiting for the epel repo to finish updating

D S
@MS do all of them to set up your environment

M S
@DS there are different setups hot machine and then the nodes - I think I lost the flow

M S
Those commands are not in sync

sander v
https://pastebin.com/uQ8S2a0b

D S
@MS for the basic passwordless access set up it's the same for all machines

A P
is it mandatory to create inventory to list all hosts ? Can I use hosts to list all hosts

S N
ssh-copy-id is failing

D S
@SN what error?

S N
$ ssh-copy-id ansible1 /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys Permissio

P S
AP yes you can use hosts

S N
Permission denied (publickey,gssapi-keyex,gssapi-with-mic).

P S
with hosts file just run, ansible all --list-hosts

M B
@SN > You have to setup sshd to accept password for first connexion

D S
@SN did you create the ansible user on each host

p m
systemctl restart sshd

p m
and then it works

V H
Has the break started?

S N
setting PasswordAuthentication as yes worked

S N
Thanks!

N C
3h not 4h?

N S
ansible-3h

M S
When I add %wheel to th etc/sudoers it's complaining that : %wheel NOPASSWD is not correctly formatted

P S
Should be...... %wheel ALL=(ALL) NOPASSWD:ALL

M S
k got i

M S
%wheel ALL=(ALL) NOPASSWD:ALL

M K
%wheel ALL=(ALL) NOPASSWD: ALL

M S
I followed the screenshot as per Sander

Derek H
Break time - class will resume shortly.

M S
I am at step 5 of "installing ansible lab":

M S
getting this error:

M S
/usr/bin/ssh-copy-id: ERROR: No identities found

P S
You need to create an identify first with ssh-keygen

M S
epel-release is only relevant in Centos like Linux OS, I dont need to do it for my ubutnus host

M S
*ubuntu

P S
accept all the defaults

M S
PS: thanks for reply, I did just run ssh-keygen command, what am I missing?

M K
what git clone command do we need to run and on which host?

M S
ssh-copy-id isnt correct int he screen of the example

Derek H
Break has concluded. Class will now continue.

M B
@MK > git clone https://github.com/sandervanvugt/ansible-3h.git

M B
on the control server

M K
thank you

p m
ll

N S
ansible -i inventory ansible1 -m command -a who

M S
where do we define ansible1 ? cannot ping

S N
/etc/hosts file

M K
what folder are we supposed to work in? the cloned git install folder or the one we created oursel ves?

M R
scp

M B
Scp

S V
scp

M R
instead of cp

F A
scp

L H
u passed it, cp

M S
[ansible@Cent1 ~]$ ansible ansible1 -m command -a who [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

M S
I can ping now but no commands

S N
did you create te inventory file?

G B
Thanks Sander!

M S
should inventory file also have IP addresses in it?

M S
currently inventory file contains:

R M
yea it can

M S
control.example.com ansible1.example.com ansible2.example.com

S N
depends on what you are using in the command

R M
https://docs.ansible.com/ansible/latest/network/getting_started/first_inventory.html

M S
thanks all

D S
@MS you don't need ip addresses in your inventory if you've set them up in /etc/hosts

M S
ok, I do have them in hosts

D S
that should be enough

M S
literally just:

M S
control.example.com

M S
ansible1.example.com

D S
thats correct

M S
still getting the error when running command?

D S
which directory are you in?

M S
inventory is in ~/install/inventory

S N
what command you are running?

M S
ansible ansible1 -m command -a who

S N
yeah that short name is not in inventory that's the reason

M S
which part is the short name?

S N
ansible1

M S
ansible1 vs ansible.example.com?

S N
yes

D S
yes

S N
use the long name and run the command

D S
or change your /etc/hosts to reference the short name

M S
>__< same error

M S
oh ok I have short name in hosts and long name in inventory

M S
maybe that's the issue

D S
needs to be the same

D S
You can have both in your /etc/hosts file

D S
i.e.

D S
192.X.X.X long.name short.name

S N
what command is used to get that list of modules?

R M
ansible-doc -l

P S
ansible-doc -l

S N
thank you

L H
ty

sander v
https://pastebin.com/u/sandervanvugt

L H
yes

L H
still here

P S
yes, no!

S S
we are here

R M
still here!

F L
everything ok so far

L S
yes

M T
Still here

P S
yes

p m
everything is c lear

H A
no questions, thanks

I P
we have left

S S
lol

L H
computational cluster

L H
like a rock cluster

L H
will do

J G
could you add multiple contents underneath the "copy" play?

R M
https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html

J G
thx

Derek H
Break time - class will resume shortly.

A P
Before installing S/W , need to download the binaries . and then specify the name in yum module . Am I correct?

M B
It will be installed from repository, no need to download anything

A P
Thanks.

A P
another query : How to check the repository to verify that s/w is available ? like Oracle S/W ?

Derek H
Break has concluded. Class will now continue.

M B
@AP > For exemple with 'ansible all -m command -a "yum search vsftpd"' or better with yum module ;)

A P
ok

M K
@AP what do you mean oracle s/w is available? you're not getting oracle db rpms in repos unless you're on oracle linux ;) as to other - you can use shell/command modules to run appropriate tools for package deployments

M K
@AP - https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html#parameter-list

A P
This was the reason, I asked. no rpm for oracle db is available. I got it from your reply.

M K
@AP you can always create rpms and add them to your local repo on control node, and config yum/rpm on nodes to use this repo... or simply copy packages directly onto the nodes and then run packagemanager modules you need pointing it to that local rpm file

A P
thanks

N C
thanks :)

L H
neovim?

L H
need quotes?

M K
@AP - check something like https://medium.com/oracledevs/devops-series-automate-oracle-19c-rdbms-installations-with-ansible-github-43cfdf344a4a or https://awesomeopensource.com/project/oravirt/ansible-oracle

K B
@AP: You might want to reach out to Oracle directly. Open a service request or talk to your customer service manager. I know based on conversations with DBAs at big companies here in the Dallas area... they're working on Ansible playbooks.

K B
@MK: Good links! I never would have found them!

M K
@AP @KB yeah, they even have their own licensed ansible tower with modules already ready... they can offer it as another subscription/license fee, but they often try to 'encourage' the use of OCI or OracleLinux...

M K
@AP @KB you can always write your own modules... installation usually can be done using response files, and these can be easily created with ansible and its fact and variable usage...

L H
ok

A P
thanks for the link

M K
@AP & @KB - just FYI, IMHO the best option is to use GoldenImages w/RO OraHomes - to deploy all you need is simple file copy/unarchiving + text edits. as a bonus, you're getting a pretty standardised environment that's great for updates later !

L H
ok

F A
hi

F A
can u show the last playbook?

Derek H
Break time - class will resume shortly.

F A
;)

M B
Good to know, filter accept wilcard: ansible all -m setup -a "filter=*kernel*"

K B
@MK: Have used GoldenImages for years. Still have to rely on an underlying process to create them. It would be really nice to move to a "declarative" method of creating everything. With moving to cloud-based platforms... probably less of an issue over time

Derek H
The slides have been uploaded. Please refresh your browser during this break to see them. They are titled "updated slides".

K B
Awesome! Thank you Derek!

Derek H
You're welcome KB

Derek H
Break has concluded. Class will now continue.

G B
yes

K B
@ALL: Anyone using Jinja? Any good links or leads?

S N
is there any good site which explains briefly about Jinja filters

M B
https://learning.oreilly.com/library/view/practical-ansible-2/9781789807462/0d9cdb7d-12b9-4749-8389-4cb7599ea212.xhtml

S N
Thank you @M B

K B
@MB: Awesome! Thank you! :-)

G B
thx!

-----------------------------------------

rhce8-book

base
mkdir group_vars
vi group_vars/file
vi greeter.yaml

---
- name: test group vars
  hosts: file 
  tasks:
  - debug:
     msg: the greeting is {{ greet }} 

tree group_vars/
cat group_vars/file
greet: hellow

cd loops/
vi register2.yml   $ a nice example 


 - name: retrieve the list of home directories
   command: ls /home
   register: home_dirs

...

https://pastebin.com/E86G07v4

- name: debugging
  debug:
    var: home_dirs

--------------------------------------
Sander van Vugt on 011921 

yum install -y vim bash-completion git 

Understanding Ansible

written in Python 
push-based
doesn't require any agent 
Configurations are written in YAML
it uses playbooks to run tasks in a way that always gives the same result
it can manage computers, network devices

Requirements:
           python, ssh, sudo configuration 


 
